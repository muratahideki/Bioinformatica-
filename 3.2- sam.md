## SAM


-  o arquivo .sam é legível
-  o arquivo .bam é binário, mas é menos pesado
  
``` bash
samtools view -S -b saida.sam > arquivo.bam
samtools sort arquivo.bam -o arquivo_sorted.bam
samtools index arquivo_sorted.bam
```

`samtools sort` Ordena o BAM por posição no genoma
- Muitos programas de análise (ex: bcftools, featureCounts, IGV, samtools index) só funcionam com arquivos BAM ordenados.
- A ordenação permite acesso rápido a regiões específicas do genoma (ex: “mostre apenas o cromossomo 3, posição 5M–6M”).

indexação con `index`
- Cria o arquivo .bai correspondente

para avaliar a estátistica de alinhamento 

```bash
samtools flagstat arquivo_sorted.bam
```

meu resultado

```bash
99703136 + 0 in total (QC-passed reads + QC-failed reads)
36718022 + 0 primary
62985114 + 0 secondary
0 + 0 supplementary
0 + 0 duplicates
0 + 0 primary duplicates
98655237 + 0 mapped (98.95% : N/A)
35670123 + 0 primary mapped (97.15% : N/A)
36718022 + 0 paired in sequencing
18359011 + 0 read1
18359011 + 0 read2
31916258 + 0 properly paired (86.92% : N/A)
35284734 + 0 with itself and mate mapped
385389 + 0 singletons (1.05% : N/A)
2371464 + 0 with mate mapped to a different chr
491610 + 0 with mate mapped to a different chr (mapQ>=5)
```

- ~99,7 milhões de reads no total (QC-passed + QC-failed): boa quantidade para análise de RNA-seq.

- Primary → a posição “principal” do alinhamento de uma read (importante para contagem de genes).
- Secondary → múltiplos alinhamentos (reads multimapeadas).
- 36,7M primárias e 62,9M secundárias.
- Para RNA-seq, apenas reads primárias contam para quantificação (featureCounts usa apenas primárias por padrão).

- ~98,95% das reads estão alinhadas ao genoma → excelente.
- 97,15% das reads primárias mapeadas → muito bom, indica alta qualidade de alinhamento.

- ~36,7M pares (paired-end).
- 86,92% estão corretamente pareados → aceitável para RNA-seq. Ideal é >85%.

- Apenas 1,05% singletons → muito baixo, ótimo.
- Poucos pares com mapeamento em cromossomos diferentes, normal.

- Pontos fortes:

Alta porcentagem de reads mapeadas (97–99%)

Baixo número de singletons

Pares corretamente mapeados suficientes para quantificação confiável
